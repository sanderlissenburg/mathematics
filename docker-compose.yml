version: '3'

services:
  php-fpm:
    build:
      context: './'
      dockerfile: './docker/php-fpm/Dockerfile'
    volumes:
      - ./:/var/www/html/:cached
    networks:
      - mathematics
    labels:
      - "traefik.enable=false"

  nginx:
    build:
      context: './'
      dockerfile: './docker/nginx/Dockerfile'
    volumes:
      - ./public:/var/www/html/public:cached
    networks:
      - mathematics
      - lissenburg-cluster
    labels:
      - "traefik.frontend.rule=Host:mathematics.lissenburg.local"

networks:
    lissenburg-cluster:
        external:
            name: lissenburg-cluster
    mathematics:
        driver: bridge
